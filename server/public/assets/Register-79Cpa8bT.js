import{b as h}from"./index-D_Ud7IQM.js";import{a as P}from"./users-BqEQ9Ml1.js";import{d as V,r as m,a as v,c as a,w as n,x as O,f as u,u as S,b as r,e as i,j as w,L as j,P as E,g as p,k as I,v as T}from"./index-DtDkd7E5.js";const W=["src"],$={key:1},z=I("div",{class:"ant-upload-text"},"上传头像",-1),H=V({__name:"Register",setup(A){const g=S(),f=m(),x={labelCol:{span:6},wrapperCol:{span:14}},e=m({nickname:"",username:"",password:"",avatar:"",age:0,gender:""}),_=m([]),d=m(!1),y=o=>{if(o.file.status==="uploading"){d.value=!0;return}o.file.status==="done"&&(d.value=!1,e.value.avatar=o.file.response.path),o.file.status==="error"&&(d.value=!1,T.error("上传失败"))},C={nickname:[{required:!0,message:"请输入昵称",trigger:"change"}],username:[{required:!0,message:"请输入账号",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"change"},{min:6,message:"密码最小6位",trigger:"change"}],avatar:[{required:!0,message:"请上传头像",trigger:"change"}],age:[{required:!0,message:"请选择年龄",trigger:"change"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}]},U=()=>{f.value.validate().then(()=>{P(e.value).then(o=>{console.log(o),o.data.ok===1&&g.push("/login")})}).catch(o=>{console.log("error",o)})};return(o,t)=>{const q=r("a-upload"),s=r("a-form-item"),c=r("a-input"),L=r("a-input-password"),B=r("a-input-number"),k=r("a-radio"),R=r("a-radio-group"),N=r("a-form"),b=r("a-button");return i(),v("div",null,[a(N,O({ref_key:"formRef",ref:f,model:e.value},x,{rules:C}),{default:n(()=>[a(s,{label:"头像",name:"avatar"},{default:n(()=>[a(q,{"file-list":_.value,"onUpdate:fileList":t[0]||(t[0]=l=>_.value=l),"list-type":"picture-card","show-upload-list":!1,maxCount:1,action:u(h)+"upload",onChange:y},{default:n(()=>[e.value.avatar?(i(),v("img",{key:0,style:{"max-width":"100%","max-height":"100%"},src:e.value.avatar.startsWith("http")?e.value.avatar:u(h)+e.value.avatar,alt:"avatar"},null,8,W)):(i(),v("div",$,[d.value?(i(),w(u(j),{key:0})):(i(),w(u(E),{key:1})),z]))]),_:1},8,["file-list","action"])]),_:1}),a(s,{label:"昵称",name:"nickname"},{default:n(()=>[a(c,{value:e.value.nickname,"onUpdate:value":t[1]||(t[1]=l=>e.value.nickname=l)},null,8,["value"])]),_:1}),a(s,{label:"账号",name:"username"},{default:n(()=>[a(c,{value:e.value.username,"onUpdate:value":t[2]||(t[2]=l=>e.value.username=l)},null,8,["value"])]),_:1}),a(s,{label:"密码",name:"password"},{default:n(()=>[a(L,{value:e.value.password,"onUpdate:value":t[3]||(t[3]=l=>e.value.password=l)},null,8,["value"])]),_:1}),a(s,{label:"年龄",name:"age"},{default:n(()=>[a(B,{value:e.value.age,"onUpdate:value":t[4]||(t[4]=l=>e.value.age=l),min:0,max:100},null,8,["value"])]),_:1}),a(s,{name:"gender",label:"性别"},{default:n(()=>[a(R,{value:e.value.gender,"onUpdate:value":t[5]||(t[5]=l=>e.value.gender=l)},{default:n(()=>[a(k,{value:"male"},{default:n(()=>[p("男")]),_:1}),a(k,{value:"female"},{default:n(()=>[p("女")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},16,["model"]),a(b,{type:"primary",onClick:U},{default:n(()=>[p("注册")]),_:1}),a(b,{onClick:t[6]||(t[6]=l=>u(g).push("/login"))},{default:n(()=>[p("已有账号？去登录→")]),_:1})])}}});export{H as default};
